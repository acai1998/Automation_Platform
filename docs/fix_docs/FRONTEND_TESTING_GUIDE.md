# 前端测试指南 - 远程仓库同步功能

## 🌐 访问前端

打开浏览器访问: **http://localhost:5174/repositories**

---

## 📋 测试步骤

### 1️⃣ 查看仓库列表

**预期效果**:
- 显示所有已配置的仓库
- 显示仓库状态（active/inactive/error）
- 显示最后同步时间
- 显示快速操作按钮

**验证项**:
- [ ] 页面加载成功
- [ ] 显示 "SeleniumBase-CI Debug" 仓库
- [ ] 显示仓库状态为 "active"
- [ ] 显示最后同步时间

---

### 2️⃣ 查看仓库详情

**操作**: 点击仓库列表中的仓库名称或详情按钮

**预期效果**:
- 显示仓库的完整配置信息
- 显示 Git URL
- 显示脚本类型和路径模式
- 显示同步设置

**验证项**:
- [ ] 显示仓库名称: "SeleniumBase-CI Debug"
- [ ] 显示 URL: https://gitee.com/Ac1998/SeleniumBase-CI.git
- [ ] 显示脚本类型: Python
- [ ] 显示路径模式: test_case/**/*.py

---

### 3️⃣ 手动触发同步

**操作**: 点击"同步"或"立即同步"按钮

**预期效果**:
- 显示同步进度提示
- 同步完成后显示成功消息
- 显示同步结果统计

**验证项**:
- [ ] 同步操作开始
- [ ] 显示进度提示（可选）
- [ ] 同步完成后显示成功消息
- [ ] 显示统计信息:
  - 总文件数: 53
  - 新增文件: 0（第二次同步）
  - 创建用例: 0（第二次同步）

---

### 4️⃣ 查看同步日志

**操作**: 点击"查看日志"或"同步历史"按钮

**预期效果**:
- 显示同步日志列表
- 显示每次同步的详细信息
- 显示同步时间、状态、文件统计

**验证项**:
- [ ] 页面加载成功
- [ ] 显示至少 1 条同步日志
- [ ] 日志显示:
  - 同步类型: manual
  - 状态: success
  - 总文件数: 53
  - 创建用例: 53
  - 时间戳

---

### 5️⃣ 编辑仓库配置

**操作**: 点击"编辑"或"修改"按钮

**预期效果**:
- 打开编辑表单
- 显示当前配置
- 允许修改配置

**验证项**:
- [ ] 表单加载成功
- [ ] 显示所有配置字段
- [ ] 可以修改配置
- [ ] 修改后可以保存

---

### 6️⃣ 创建新仓库

**操作**: 点击"创建仓库"或"新增"按钮

**预期效果**:
- 打开创建表单
- 显示所有必填字段
- 允许输入仓库信息

**验证项**:
- [ ] 表单加载成功
- [ ] 显示所有必填字段:
  - 仓库名称
  - 仓库 URL
  - 分支
  - 脚本类型
  - 路径模式
- [ ] 可以测试连接
- [ ] 可以获取分支列表
- [ ] 可以创建仓库

---

## 🧪 高级测试场景

### 场景 1: 增量同步测试

1. 第一次同步 SeleniumBase-CI 仓库
   - 预期: 创建 53 个用例
   
2. 修改仓库配置（如路径模式）
   
3. 再次同步
   - 预期: 应该检测到变更并相应更新

### 场景 2: 错误处理测试

1. 输入无效的 Git URL
   - 预期: 显示错误提示
   
2. 输入不存在的分支
   - 预期: 显示错误提示
   
3. 输入无效的路径模式
   - 预期: 显示警告或错误

### 场景 3: 并发操作测试

1. 快速连续点击多个同步按钮
   - 预期: 应该防止并发同步或显示警告

### 场景 4: 网络异常测试

1. 在同步过程中断开网络
   - 预期: 应该显示错误并允许重试

---

## 📊 性能测试

### 加载时间
- [ ] 仓库列表页面加载 < 2 秒
- [ ] 同步日志页面加载 < 2 秒
- [ ] 编辑表单加载 < 1 秒

### 同步时间
- [ ] 首次同步 53 个文件 < 10 秒
- [ ] 增量同步 < 5 秒

### 内存占用
- [ ] 列表页面内存占用 < 50MB
- [ ] 日志页面内存占用 < 100MB

---

## 🎨 UI/UX 检查

### 布局和样式
- [ ] 页面布局清晰合理
- [ ] 按钮和链接易于识别
- [ ] 颜色搭配协调
- [ ] 深色模式支持正常

### 交互反馈
- [ ] 按钮点击有反馈
- [ ] 加载状态有提示
- [ ] 错误信息清晰
- [ ] 成功消息明显

### 响应式设计
- [ ] 桌面端显示正常
- [ ] 平板端显示正常（如适用）
- [ ] 移动端显示正常（如适用）

---

## 🔍 数据验证

### 创建的用例验证

访问用例管理页面检查导入的用例:

```bash
# 查询数据库中导入的用例
sqlite3 server/db/autotest.db \
  "SELECT COUNT(*) FROM test_cases WHERE script_path LIKE 'test_case%';"
```

**预期结果**: 53

### 同步日志验证

```bash
# 查询同步日志
sqlite3 server/db/autotest.db \
  "SELECT * FROM sync_logs WHERE repo_config_id = 2 ORDER BY created_at DESC LIMIT 5;"
```

**预期结果**: 显示同步日志记录

### 脚本映射验证

```bash
# 查询脚本映射
sqlite3 server/db/autotest.db \
  "SELECT COUNT(*) FROM repository_script_mappings WHERE repo_config_id = 2;"
```

**预期结果**: 53

---

## 🐛 常见问题排查

### 问题 1: 页面显示空白

**排查步骤**:
1. 检查浏览器控制台是否有错误
2. 检查网络请求是否成功
3. 检查后端是否正常运行

**解决方案**:
```bash
# 检查后端健康状态
curl http://localhost:3000/api/health
```

### 问题 2: 同步失败

**排查步骤**:
1. 检查网络连接
2. 检查 Git URL 是否正确
3. 检查后端日志

**解决方案**:
```bash
# 查看后端日志
tail -f server/logs/*.log
```

### 问题 3: 用例未创建

**排查步骤**:
1. 检查脚本路径模式是否正确
2. 检查脚本文件是否存在
3. 检查脚本格式是否支持

**解决方案**:
```bash
# 检查数据库中的用例
sqlite3 server/db/autotest.db \
  "SELECT * FROM test_cases WHERE script_path LIKE 'test_case%' LIMIT 5;"
```

---

## 📝 测试记录模板

```markdown
### 测试日期: YYYY-MM-DD

#### 环境信息
- 浏览器: 
- 操作系统: 
- 后端服务: 

#### 测试场景: 
- [ ] 场景 1
- [ ] 场景 2
- [ ] 场景 3

#### 测试结果
- 通过: 
- 失败: 
- 异常: 

#### 截图
(附加相关截图)

#### 备注
(记录其他信息)
```

---

## 🚀 快速测试命令

```bash
# 启动项目
npm run start

# 访问前端
open http://localhost:5174/repositories

# 创建测试仓库
curl -X POST http://localhost:3000/api/repositories \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Test Repo",
    "repo_url": "https://github.com/example/repo.git",
    "branch": "main",
    "script_type": "javascript",
    "script_path_pattern": "**/*.test.js",
    "auto_create_cases": true
  }'

# 触发同步
curl -X POST http://localhost:3000/api/repositories/1/sync \
  -H "Content-Type: application/json" \
  -d '{"triggeredBy": 1}'

# 查看日志
curl http://localhost:3000/api/repositories/1/sync-logs

# 查看用例
curl http://localhost:3000/api/cases?limit=50
```

---

## ✅ 测试清单

完成以下所有项目以验证功能完整性:

- [ ] 仓库列表显示正常
- [ ] 可以创建新仓库
- [ ] 可以编辑仓库配置
- [ ] 可以删除仓库
- [ ] 可以手动触发同步
- [ ] 同步成功后显示结果
- [ ] 可以查看同步日志
- [ ] 可以查看日志详情
- [ ] 用例已成功导入
- [ ] 用例信息完整准确
- [ ] 前端页面无 JavaScript 错误
- [ ] 前端页面加载速度正常
- [ ] 深色模式正常工作
- [ ] 响应式布局正常

---

**最后更新**: 2025-12-31  
**状态**: 可进行前端测试