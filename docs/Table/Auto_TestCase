-- autotest.Auto_TestCase definition

CREATE TABLE `Auto_TestCase` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '用例唯一标识',
  `case_key` varchar(200) NOT NULL COMMENT '用例唯一Key（函数名 / case_id）',
  `name` varchar(200) NOT NULL COMMENT '用例展示名称',
  `description` text DEFAULT NULL COMMENT '用例描述',
  `project_id` int(11) DEFAULT NULL COMMENT '所属项目ID',
  `repo_id` int(11) NOT NULL COMMENT '所属仓库ID',
  `module` varchar(100) DEFAULT NULL COMMENT '功能模块名称',
  `priority` enum('P0','P1','P2','P3') DEFAULT 'P1' COMMENT '优先级',
  `type` enum('api','ui','performance','security') DEFAULT 'api' COMMENT '用例类型',
  `tags` varchar(500) DEFAULT NULL COMMENT '标签',
  `owner` varchar(100) DEFAULT NULL COMMENT '用例负责人',
  `source` enum('git','manual') DEFAULT 'git' COMMENT '来源',
  `enabled` tinyint(1) DEFAULT 1 COMMENT '是否有效（Git 中删除则 false）',
  `last_sync_commit` varchar(100) DEFAULT NULL COMMENT '最近同步 commit',
  `script_path` varchar(500) DEFAULT NULL COMMENT '测试脚本文件路径',
  `config_json` text DEFAULT NULL COMMENT '用例配置JSON',
  `created_by` int(11) DEFAULT NULL COMMENT '创建人ID',
  `updated_by` int(11) DEFAULT NULL COMMENT '最后修改人ID',
  `created_at` datetime DEFAULT current_timestamp() COMMENT '创建时间',
  `updated_at` datetime DEFAULT current_timestamp() ON UPDATE current_timestamp() COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uniq_repo_case` (`repo_id`,`script_path`(255)),
  KEY `idx_cases_project` (`project_id`),
  KEY `idx_cases_module` (`module`),
  KEY `idx_type` (`type`),
  KEY `idx_priority` (`priority`),
  KEY `idx_enabled` (`enabled`),
  KEY `fk_case_created_by` (`created_by`),
  KEY `fk_case_updated_by` (`updated_by`),
  CONSTRAINT `fk_case_created_by` FOREIGN KEY (`created_by`) REFERENCES `Auto_Users` (`id`) ON DELETE SET NULL,
  CONSTRAINT `fk_case_project` FOREIGN KEY (`project_id`) REFERENCES `Auto_TestCaseProjects` (`id`) ON DELETE CASCADE,
  CONSTRAINT `fk_case_updated_by` FOREIGN KEY (`updated_by`) REFERENCES `Auto_Users` (`id`) ON DELETE SET NULL
) ENGINE=InnoDB AUTO_INCREMENT=2316 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='测试用例资产表';